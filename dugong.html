
<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
    <title>Sound the duGong!</title>

    <link rel="stylesheet" href="http://code.leafletjs.com/leaflet-0.3.1/leaflet.css" />
    <!--[if lte IE 8]>
      <link rel="stylesheet" href="http://code.leafletjs.com/leaflet-0.3.1/leaflet.ie.css" />
    <![endif]-->

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="http://code.leafletjs.com/leaflet-0.3.1/leaflet.js"></script>
    <script src="/lib/crossfilter.min.js"></script>
    <script src="/lib/d3.v2.min.js"></script>
    
    <script type='text/javascript'>
      $(function() {
        // Global object
        window.DUGONG = {};

        //Build the map
        window.DUGONG.map = new L.Map('map', {
          center: new L.LatLng(51.505, -0.09), 
          zoom: 13
        });

        // create a CloudMade tile layer
        var cloudmadeUrl = 'http://{s}.tile.cloudmade.com/f6825bb39564441ea5548f3886452056/997/256/{z}/{x}/{y}.png',
        cloudmade = new L.TileLayer(cloudmadeUrl, {maxZoom: 18});

        // add the CloudMade layer to the map
        window.DUGONG.map.addLayer(cloudmade);

        // Crossfilter
        window.DUGONG.payments = crossfilter([
          {date: "2011-11-14T16:17:54Z", quantity: 2, total: 190, tip: 100, type: "tab"},
          {date: "2011-11-14T16:20:19Z", quantity: 2, total: 190, tip: 100, type: "tab"},
          {date: "2011-11-14T16:28:54Z", quantity: 1, total: 300, tip: 200, type: "visa"},
          {date: "2011-11-14T16:30:43Z", quantity: 2, total: 90, tip: 0, type: "tab"},
          {date: "2011-11-14T16:48:46Z", quantity: 2, total: 90, tip: 0, type: "tab"},
          {date: "2011-11-14T16:53:41Z", quantity: 2, total: 90, tip: 0, type: "tab"},
          {date: "2011-11-14T16:54:06Z", quantity: 1, total: 100, tip: 0, type: "cash"},
          {date: "2011-11-14T16:58:03Z", quantity: 2, total: 90, tip: 0, type: "tab"},
          {date: "2011-11-14T17:07:21Z", quantity: 2, total: 90, tip: 0, type: "tab"},
          {date: "2011-11-14T17:22:59Z", quantity: 2, total: 90, tip: 0, type: "tab"},
          {date: "2011-11-14T17:25:45Z", quantity: 2, total: 200, tip: 0, type: "cash"},
          {date: "2011-11-14T17:29:52Z", quantity: 1, total: 200, tip: 100, type: "visa"}
        ]);

        // Crossfilter dimension
        window.DUGONG.paymentsByTotal = DUGONG.payments.dimension(function(d) { return d.total; });
        
      });
    </script>
  </head>
  <body>
    <div id='map'  style="height: 200px"></div>
    <div id='timelines'></div>
  </body>
</html>

